[INFO: 2023-08-19 23:18:14,136] Training with config:
[INFO: 2023-08-19 23:18:14,160] {'DATA_LOADER': {'DROP_LAST': True,
                 'INPUT_SENTENCE_PATH': './data_vg/vg_input_pad_train_segment_sentences.pkl',
                 'INPUT_SEQ_PATH': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/vg_train_input.pkl',
                 'MAX_FEAT': 100,
                 'NUM_WORKERS': 4,
                 'OUTPUT_SENTENCE_PATH': './data_vg/vg_output_pad_train_segment_sentences.pkl',
                 'PIN_MEMORY': True,
                 'SEQ_PER_IMG': 1,
                 'SHUFFLE': True,
                 'TARGET_SEQ_PATH': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/vg_train_target.pkl',
                 'TEST_ATT_FEATS': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'TEST_GV_FEAT': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'TEST_ID': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/test_ids.txt',
                 'TOPIC_LABEL_PATH': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/topic_labels_soft_kmeans/',
                 'TRAIN_ATT_FEATS': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'TRAIN_GV_FEAT': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'TRAIN_ID': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/train_ids.txt',
                 'VAL_ATT_FEATS': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'VAL_GV_FEAT': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/VinVL/real_stanford_paragraph_feature',
                 'VAL_ID': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/val_ids.txt'},
 'EPS': 1e-14,
 'INFERENCE': {'BEAM_SIZE': 1,
               'CAP_KEY': 'caption',
               'COCO_PATH': '../coco_caption',
               'EVAL': 'COCO',
               'GREEDY_DECODE': True,
               'ID_KEY': 'image_id',
               'TEST_ANNFILE': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/test_2k.json',
               'TRAIN_ANNFILE': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/train_14k.json',
               'VAL_ANNFILE': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/val_2k.json',
               'VOCAB': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/vg_vocab_filtered.txt'},
 'LOGGER_NAME': 'log',
 'LOSSES': {'LABELSMOOTHING': 0.1,
            'RL_TYPE': 'RewardCriterion',
            'XE_TYPE': 'LabelSmoothing'},
 'MEAN': [0.485, 0.456, 0.406],
 'MODEL': {'ATT_ACT': 'TANH',
           'ATT_FEATS_DIM': 2048,
           'ATT_FEATS_EMBED_ACT': 'CELU',
           'ATT_FEATS_EMBED_DIM': 1024,
           'ATT_FEATS_NORM': False,
           'ATT_HIDDEN_DROP': 0.0,
           'ATT_HIDDEN_SIZE': -1,
           'BILINEAR': {'ACT': 'CELU',
                        'ATTTYPE': 'SCAtt',
                        'ATT_DIM': 1024,
                        'BIFEAT_EMB_ACT': 'RELU',
                        'DECODE_ATT_MID_DIM': [128, 64, 128],
                        'DECODE_ATT_MID_DROPOUT': 0.0,
                        'DECODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'DECODE_BLOCK': 'LowRankBilinearDec',
                        'DECODE_DROPOUT': 0.5,
                        'DECODE_FF_DROPOUT': 0.1,
                        'DECODE_LAYERS': 1,
                        'DIM': 1024,
                        'ELU_ALPHA': 1.3,
                        'ENCODE_ATT_MID_DIM': [128, 64, 128],
                        'ENCODE_ATT_MID_DROPOUT': 0.0,
                        'ENCODE_BIFEAT_EMB_DROPOUT': 0.3,
                        'ENCODE_BLOCK': 'LowRankBilinearEnc',
                        'ENCODE_DROPOUT': 0.5,
                        'ENCODE_FF_DROPOUT': 0.1,
                        'ENCODE_LAYERS': 4,
                        'HEAD': 8,
                        'TYPE': 'LowRank'},
           'BOTTOM_UP': {'DROPOUT_FIRST_INPUT': 0.0, 'DROPOUT_SEC_INPUT': 0.0},
           'DROPOUT_ATT_EMBED': 0.5,
           'DROPOUT_GV_EMBED': 0.0,
           'DROPOUT_LM': 0.5,
           'DROPOUT_WORD_EMBED': 0.5,
           'GVFEAT_DIM': 2048,
           'GVFEAT_EMBED_ACT': 'NONE',
           'GVFEAT_EMBED_DIM': -1,
           'RNN_SIZE': 1024,
           'SEQ_LEN': 175,
           'TOPIC_SIZE': 81,
           'TRANSFORMER': {'PE_MAX_LEN': 5000},
           'TYPE': 'XLAN_SUPTOPIC_V6_SAP',
           'USE_TOP': 0,
           'VOCAB_SIZE': 6111,
           'WORD_EMBED_ACT': 'CELU',
           'WORD_EMBED_DIM': 1024,
           'WORD_EMBED_NORM': False},
 'PARAM': {'ACC_DIFF': 'ACC_DIFF',
           'ACC_NUM': 'ACC_NUM',
           'ALL_INPUT_SENTENCE': 'ALL_INPUT_SENTENCE',
           'ALL_OUTPUT_SENTENCE': 'ALL_OUTPUT_SENTENCE',
           'ATTN_LABELS': 'ATTN_LABELS',
           'ATTR_FEATS': 'ATTR_FEATS',
           'ATT_FEATS': 'ATT_FEATS',
           'ATT_FEATS_MASK': 'ATT_FEATS_MASK',
           'GLOBAL_FEAT': 'GV_FEAT',
           'H_ATT': 'H_ATT',
           'IMAGE_ID': 'IMAGE_ID',
           'INDICES': 'INDICES',
           'INPUT_SENT': 'INPUT_SENT',
           'INPUT_TOPIC_LABELS_HARD': 'INPUT_TOPIC_LABELS_HARD',
           'MAX_SEQS': 'MAX_SEQS',
           'OLD_STATE': 'OLD_STATE',
           'OUTPUT_TOPIC_LABELS_HARD': 'OUTPUT_TOPIC_LABELS_HARD',
           'PREVIOUS_TOPIC': 'PREVIOUS_TOPIC',
           'P_ATTR_FEATS': 'P_ATTR_FEATS',
           'P_ATT_FEATS': 'P_ATT_FEATS',
           'SENT_INDEX': 'SENT_INDEX',
           'SOFT_LABELS': 'SOFT_LABELS',
           'STACKED_SPATIAL': 'STACKED_SPATIAL',
           'STATE': 'STATE',
           'STATE_TOPIC': 'STATE_TOPIC',
           'SUBSEQUENT_MAT': 'SUBSEQUENT_MAT',
           'TARGET_SENT': 'TARGET_SENT',
           'TOPIC_FEATS': 'TOPIC_FEATS',
           'TOPIC_LABELS': 'TOPIC_LABELS',
           'TOPIC_LABELS_HARD': 'TOPIC_LABELS_HARD',
           'WORD_EMBEDDING': 'WORD_EMBEDDING',
           'WT': 'WT',
           'WT_TOPIC': 'WT_TOPIC'},
 'ROOT_DIR': '/home/tangt/my-image-to-paragraph/experiments/Xlan_SAP_V6_kmeans_real_vinvl_wt03_RL_wt05/',
 'SCORER': {'CIDER_CACHED': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/train_cider_silhouett.pkl',
            'GT_PATH': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/vg_train_gts_silhouett.pkl',
            'TOPIC_GT_PATH': '/home/tangt/nfs_tangt/code/my-image-to-paragraph/data_vg/vg_train_topic_gts_silhouett.pkl',
            'TYPES': ['Cider'],
            'WEIGHTS': [1.0]},
 'SEED': 1546884941.160048,
 'SOLVER': {'ADAM': {'BETAS': [0.9, 0.999], 'EPS': 1e-08},
            'BASE_LR': 1e-05,
            'BIAS_LR_FACTOR': 1,
            'DISPLAY': 10,
            'GRAD_CLIP': 0.5,
            'GRAD_CLIP_TYPE': 'Norm',
            'LR_POLICY': {'FACTOR': 1.0,
                          'GAMMA': 0.8,
                          'MODEL_SIZE': 1024,
                          'PLATEAU_FACTOR': 0.8,
                          'PLATEAU_PATIENCE': 3,
                          'STEPS': [3],
                          'STEP_SIZE': 3,
                          'STEP_TYPE': 'Epoch',
                          'TYPE': 'Plateau',
                          'WARMUP': 10000},
            'MAX_EPOCH': 70,
            'MAX_ITER': -1,
            'SGD': {'MOMENTUM': 0.9},
            'SNAPSHOT_ITERS': 1,
            'TEST_INTERVAL': 1,
            'TYPE': 'ADAM',
            'WEIGHT_DECAY': 0.0,
            'WEIGHT_DECAY_BIAS': 0.0},
 'STD': [0.229, 0.224, 0.225],
 'TEMP_DIR': './data/temp',
 'TEST': {'BATCH_SIZE': 50},
 'TRAIN': {'BATCH_SIZE': 5,
           'REINFORCEMENT': {'START': 0},
           'SCHEDULED_SAMPLING': {'INC_EVERY': 5,
                                  'INC_PROB': 0.05,
                                  'MAX_PROB': 0.25,
                                  'START': 0}}}
